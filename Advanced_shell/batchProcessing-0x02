#!/bin/bash

POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")
DIR="pokemon_data"
ERROR_FILE="errors.txt"

mkdir -p "$DIR"

for POKEMON in "${POKEMONS[@]}"; do
    echo "Fetching data for $POKEMON..."
    for i in {1..3}; do
        curl -s -o "$DIR/$POKEMON.json" "https://pokeapi.co/api/v2/pokemon/$POKEMON"
        if [ $? -eq 0 ] && [ -s "$DIR/$POKEMON.json" ]; then
            echo "Saved data to $DIR/$POKEMON.json âœ…"
            break
        else
            echo "Attempt $i failed for $POKEMON" >> "$ERROR_FILE"
            sleep 2
        fi
    done
    sleep 1 # prevent rate limiting
done